# -*- coding: utf-8 -*-

import pandas as pd
import pymysql
import numpy as np

"""
参考链接：
填补空缺值（平均值）
https://blog.csdn.net/tt_258/article/details/69359631
"""

## 加上字符集参数，防止中文乱码
db = pymysql.connect(
    host="localhost",  # 127.0.0.1
    database="data_mining_DB",
    user="root",
    password="root",
    port=3306,
    charset='utf8'
)

temp_table = "data_statistics_temp"
# sql语句
sqlcmd = "select * from %s" % (temp_table)

# 利用pandas 模块导入mysql数据
df = pd.read_sql(sqlcmd, db)

df1 = df.dropna()
print(df1)
""""
    id  var1   var2  var3
0    1  25.0  26.30  58.0
1    2  85.0   6.30   9.0
2    3  26.0  22.30   5.0
3    4  48.0  15.20   1.0
4    5  96.0  10.20   2.0
5    6  54.0   3.50   7.0
6    7  21.0   7.30   8.0
7    8   3.0  85.20   3.0
8    9  96.0  56.00   5.0
9   10  35.0  21.50   2.0
10  11  45.0  22.30   3.0
11  12  68.0  23.60  58.0
12  13  78.0  25.89  69.0
13  14  95.0  14.25  47.0
14  15  21.0  23.80  21.0
15  16  32.0  25.30  65.0
16  17  14.0  22.30  12.0
17  18  20.0  65.20  75.0
18  19   6.0  89.20  25.0
19  20  98.0  45.80  78.0
20  21  82.0  23.20  35.0
"""

print("==================================")

data0 = df.iloc[1:-1]
df2 = df.fillna(data0.mean())
print(df2)
"""
    id       var1       var2  var3
0    1  25.000000  26.300000  58.0
1    2  85.000000   6.300000   9.0
2    3  26.000000  22.300000   5.0
3    4  48.000000  15.200000   1.0
4    5  96.000000  10.200000   2.0
5    6  54.000000   3.500000   7.0
6    7  21.000000   7.300000   8.0
7    8   3.000000  85.200000   3.0
8    9  96.000000  56.000000   5.0
9   10  35.000000  21.500000   2.0
10  11  45.000000  22.300000   3.0
11  12  68.000000  23.600000  58.0
12  13  78.000000  25.890000  69.0
13  14  95.000000  14.250000  47.0
14  15  21.000000  23.800000  21.0
15  16  32.000000  25.300000  65.0
16  17  14.000000  22.300000  12.0
17  18  20.000000  65.200000  75.0
18  19   6.000000  89.200000  25.0
19  20  98.000000  45.800000  78.0
20  21  82.000000  23.200000  35.0
21  22  49.047619   6.300000  26.5
22  23   7.000000  29.268571  26.5
23  24  49.047619  29.268571  14.0
"""

print("++++++++++++++++")
print(data0.mean())
"""
id      12.500000
var1    49.047619
var2    29.268571
var3    26.500000
dtype: float64
"""